/*!
 * bootstrap-typeahead.js v0.0.6 (http://www.upbootstrap.com)
 * Copyright 2012-2018 Twitter Inc.
 * Licensed under MIT (https://github.com/biggora/bootstrap-ajax-typeahead/blob/master/LICENSE)
 * See Demo: http://plugins.upbootstrap.com/bootstrap-ajax-typeahead
 * Updated: 2018-01-02 10:40:44
 *
 * Modifications by Paul Warelis and Alexey Gordeyev
 */
!function(a){"use strict";var b=function(b,c){var d,e=(a.fn.typeahead.defaults,this);c.scrollBar&&(c.items=100,c.menu='<ul class="typeahead dropdown-menu" style="max-height:220px;overflow:auto;"></ul>'),e.$element=a(b),e.options=a.extend({},a.fn.typeahead.defaults,c),e.$menu=a(e.options.menu).insertAfter(e.$element),e.eventSupported=e.options.eventSupported||e.eventSupported,e.grepper=e.options.grepper||e.grepper,e.highlighter=e.options.highlighter||e.highlighter,e.lookup=e.options.lookup||e.lookup,e.matcher=e.options.matcher||e.matcher,e.render=e.options.render||e.render,e.onSelect=e.options.onSelect||null,e.sorter=e.options.sorter||e.sorter,e.select=e.options.select||e.select,e.updater=e.options.updater||e.updater,e.source=e.options.source||e.source,e.displayField=e.options.displayField||e.displayField,e.valueField=e.options.valueField||e.valueField,e.autoSelect=e.options.autoSelect||e.autoSelect,e.options.ajax?(d=e.options.ajax,"string"==typeof d?e.ajax=a.extend({},a.fn.typeahead.defaults.ajax,{url:d}):("string"==typeof d.displayField&&(e.displayField=e.options.displayField=d.displayField),"string"==typeof d.valueField&&(e.valueField=e.options.valueField=d.valueField),e.ajax=a.extend({},a.fn.typeahead.defaults.ajax,d)),e.ajax.url||(e.ajax=null),e.query=""):(e.source=e.options.source,e.ajax=null),e.shown=!1,e.listen()};b.prototype={constructor:b,eventSupported:function(a){var b=this.$element.hasOwnProperty(a);return b||(this.$element.setAttribute(a,"return;"),b="function"==typeof this.$element[a]),b},select:function(){var a,b,c=this.$menu.find(".active");return c.length&&(a=c.attr("data-value"),b=this.$menu.find(".active a").text(),this.$element.val(this.updater(b)).change(),this.options.onSelect&&this.options.onSelect({value:a,text:b})),this.hide()},updater:function(a){return a},show:function(){var b,c=a.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:c.top+c.height,left:c.left}),this.options.alignWidth&&(b=a(this.$element[0]).outerWidth(),this.$menu.css({width:b})),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},ajaxLookup:function(){function b(){this.ajaxToggleLoadClass(!0),this.ajax.xhr&&this.ajax.xhr.abort();var b=this.ajax.preDispatch?this.ajax.preDispatch(c):{query:c};this.ajax.xhr=a.ajax({url:this.ajax.url,data:b,success:a.proxy(this.ajaxSource,this),type:this.ajax.method||"get",dataType:"json",headers:this.ajax.headers||{}}),this.ajax.timerId=null}var c=a.trim(this.$element.val());return c&&c===this.query?this:(this.query=c,this.ajax.timerId&&(clearTimeout(this.ajax.timerId),this.ajax.timerId=null),c.length<this.ajax.triggerLength?(this.ajax.xhr&&(this.ajax.xhr.abort(),this.ajax.xhr=null,this.ajaxToggleLoadClass(!1)),this.shown?this.hide():this):(this.ajax.timerId=setTimeout(a.proxy(b,this),this.ajax.timeout),this))},ajaxSource:function(a){this.ajaxToggleLoadClass(!1);var b,c=this;if(c.ajax.xhr)return c.ajax.preProcess&&(a=c.ajax.preProcess(a)),c.ajax.data=a,b=c.grepper(c.ajax.data)||[],b.length?(c.ajax.xhr=null,c.render(b.slice(0,c.options.items)).show()):c.shown?c.hide():c},ajaxToggleLoadClass:function(a){this.ajax.loadingClass&&this.$element.toggleClass(this.ajax.loadingClass,a)},lookup:function(a){var b,c=this;return c.ajax?void c.ajaxer():(c.query=c.$element.val(),c.query&&(b=c.grepper(c.source))?(0===b.length&&(b[0]={id:-21,name:"Result not Found"}),c.render(b.slice(0,c.options.items)).show()):c.shown?c.hide():c)},matcher:function(a){return a.toLowerCase().indexOf(this.query.toLowerCase())<0},sorter:function(a){if(!this.options.ajax){for(var b,c=[],d=[],e=[];void 0!==(b=a.shift());)b.toLowerCase().indexOf(this.query.toLowerCase())?b.indexOf(this.query)<0?d.push(b):e.push(b):c.push(b);return c.concat(d,e)}return a},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c,d=this,e="string"==typeof d.options.displayField;return b=a(b).map(function(b,f){return"object"==typeof f?(c=e?f[d.options.displayField]:d.options.displayField(f),b=a(d.options.item).attr("data-value",f[d.options.valueField])):(c=f,b=a(d.options.item).attr("data-value",f)),b.find("a").html(d.highlighter(c)),b[0]}),d.autoSelect&&b.first().addClass("active"),this.$menu.html(b),this},grepper:function(b){var c,d,e=this,f="string"==typeof e.options.displayField;if(!(f&&b&&b.length))return null;if(b[0].hasOwnProperty(e.options.displayField))c=a.grep(b,function(a){return d=f?a[e.options.displayField]:e.options.displayField(a),e.matcher(d)});else{if("string"!=typeof b[0])return null;c=a.grep(b,function(a){return e.matcher(a)})}return this.sorter(c)},next:function(b){var c,d=this.$menu.find(".active").removeClass("active"),e=d.next();e.length||(e=a(this.$menu.find("li")[0])),this.options.scrollBar&&(c=this.$menu.children("li").index(e),c%8===0&&this.$menu.scrollTop(26*c)),e.addClass("active")},prev:function(a){var b,c,d,e=this.$menu.find(".active").removeClass("active"),f=e.prev();f.length||(f=this.$menu.find("li").last()),this.options.scrollBar&&(b=this.$menu.children("li"),c=b.length-1,d=b.index(f),(c-d)%8===0&&this.$menu.scrollTop(26*(d-7))),f.addClass("active")},listen:function(){this.$element.on("focus",a.proxy(this.focus,this)).on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",a.proxy(this.keydown,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this)).on("mouseleave","li",a.proxy(this.mouseleave,this))},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(b){this.suppressKeyPressRepeat=a.inArray(b.keyCode,[40,38,9,13,27])<0,this.move(b)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.ajax?this.ajaxLookup():this.lookup()}a.stopPropagation(),a.preventDefault()},focus:function(b){this.focused=!0,0==this.ajax.triggerLength&&0==a.trim(this.$element.val()).length&&(this.ajax?this.ajaxLookup():this.lookup())},blur:function(a){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(a){a.stopPropagation(),a.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(b){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")},mouseleave:function(a){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},destroy:function(){this.$element.off("focus",a.proxy(this.focus,this)).off("blur",a.proxy(this.blur,this)).off("keypress",a.proxy(this.keypress,this)).off("keyup",a.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.off("keydown",a.proxy(this.keydown,this)),this.$menu.off("click",a.proxy(this.click,this)).off("mouseenter","li",a.proxy(this.mouseenter,this)).off("mouseleave","li",a.proxy(this.mouseleave,this)),this.$element.removeData("typeahead")}},a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f="object"==typeof c&&c;e||d.data("typeahead",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.typeahead.defaults={source:[],items:10,scrollBar:!1,alignWidth:!0,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',valueField:"id",displayField:"name",autoSelect:!0,onSelect:function(){},ajax:{url:null,timeout:300,method:"get",triggerLength:1,loadingClass:null,preDispatch:null,preProcess:null}},a.fn.typeahead.Constructor=b,a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var c=a(this);c.data("typeahead")||(b.preventDefault(),c.typeahead(c.data()))})})}(window.jQuery);